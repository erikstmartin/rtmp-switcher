pub mod http;
pub mod input;
pub mod mixer;
pub mod output;

extern crate gstreamer as gst;
extern crate gstreamer_video as gst_video;
use crate::mixer::Error;

type Result<T> = std::result::Result<T, Error>;

fn gst_create_element(element_type: &str, name: &str) -> Result<gst::Element> {
    Ok(gst::ElementFactory::make(element_type, Some(name))
        .map_err(|_| Error::Gstreamer(format!("Failed to create element: {}", name)))?)
}

#[derive(serde::Serialize, serde::Deserialize, Debug, PartialEq, Clone)]
#[allow(non_camel_case_types)]
pub enum Format {
    AYUV64,
    ARGB64,
    GBRA_12LE,
    GBRA_12BE,
    Y412_LE,
    Y412_BE,
    A444_10LE,
    GBRA_10LE,
    A444_10BE,
    GBRA_10BE,
    A422_10LE,
    A422_10BE,
    A420_10LE,
    A420_10BE,
    RGB10A2_LE,
    BGR10A2_LE,
    Y410,
    GBRA,
    ABGR,
    VUYA,
    BGRA,
    AYUV,
    ARGB,
    RGBA,
    A420,
    Y444_16LE,
    Y444_16BE,
    v216,
    P016_LE,
    P016_BE,
    Y444_12LE,
    GBR_12LE,
    Y444_12BE,
    GBR_12BE,
    I422_12LE,
    I422_12BE,
    Y212_LE,
    Y212_BE,
    I420_12LE,
    I420_12BE,
    P012_LE,
    P012_BE,
    Y444_10LE,
    GBR_10LE,
    Y444_10BE,
    GBR_10BE,
    r210,
    I422_10LE,
    I422_10BE,
    NV16_10LE32,
    Y210,
    v210,
    UYVP,
    I420_10LE,
    I420_10BE,
    P010_10LE,
    NV12_10LE32,
    NV12_10LE40,
    P010_10BE,
    Y444,
    GBR,
    NV24,
    xBGR,
    BGRx,
    xRGB,
    RGBx,
    BGR,
    IYU2,
    v308,
    RGB,
    Y42B,
    NV61,
    NV16,
    VYUY,
    UYVY,
    YVYU,
    YUY2,
    I420,
    YV12,
    NV21,
    NV12,
    NV12_64Z32,
    NV12_4L4,
    NV12_32L32,
    Y41B,
    IYU1,
    YVU9,
    YUV9,
    RGB16,
    BGR16,
    RGB15,
    BGR15,
    RGB8P,
    GRAY16_LE,
    GRAY16_BE,
    GRAY10_LE32,
    GRAY8,
}

impl std::fmt::Display for Format {
    fn fmt(&self, f: &mut std::fmt::Formatter<'_>) -> std::fmt::Result {
        use Format::*;

        let s = match self {
            AYUV64 => "AYUV64",
            ARGB64 => "ARGB64",
            GBRA_12LE => "GBRA_12LE",
            GBRA_12BE => "GBRA_12BE",
            Y412_LE => "Y412_LE",
            Y412_BE => "Y412_BE",
            A444_10LE => "A444_10LE",
            GBRA_10LE => "GBRA_10LE",
            A444_10BE => "A444_10BE",
            GBRA_10BE => "GBRA_10BE",
            A422_10LE => "A422_10LE",
            A422_10BE => "A422_10BE",
            A420_10LE => "A420_10LE",
            A420_10BE => "A420_10BE",
            RGB10A2_LE => "RGB10A2_LE",
            BGR10A2_LE => "BGR10A2_LE",
            Y410 => "Y410",
            GBRA => "GBRA",
            ABGR => "ABGR",
            VUYA => "VUYA",
            BGRA => "BGRA",
            AYUV => "AYUV",
            ARGB => "ARGB",
            RGBA => "RGBA",
            A420 => "A420",
            Y444_16LE => "Y444_16LE",
            Y444_16BE => "Y444_16BE",
            v216 => "v216",
            P016_LE => "P016_LE",
            P016_BE => "P016_BE",
            Y444_12LE => "Y444_12LE",
            GBR_12LE => "GBR_12LE",
            Y444_12BE => "Y444_12BE",
            GBR_12BE => "GBR_12BE",
            I422_12LE => "I422_12LE",
            I422_12BE => "I422_12BE",
            Y212_LE => "Y212_LE",
            Y212_BE => "Y212_BE",
            I420_12LE => "I420_12LE",
            I420_12BE => "I420_12BE",
            P012_LE => "P012_LE",
            P012_BE => "P012_BE",
            Y444_10LE => "Y444_10LE",
            GBR_10LE => "GBR_10LE",
            Y444_10BE => "Y444_10BE",
            GBR_10BE => "GBR_10BE",
            r210 => "r210",
            I422_10LE => "I422_10LE",
            I422_10BE => "I422_10BE",
            NV16_10LE32 => "NV16_10LE32",
            Y210 => "Y210",
            v210 => "v210",
            UYVP => "UYVP",
            I420_10LE => "I420_10LE",
            I420_10BE => "I420_10BE",
            P010_10LE => "P010_10LE",
            NV12_10LE32 => "NV12_10LE32",
            NV12_10LE40 => "NV12_10LE40",
            P010_10BE => "P010_10BE",
            Y444 => "Y444",
            GBR => "GBR",
            NV24 => "NV24",
            xBGR => "xBGR",
            BGRx => "BGRx",
            xRGB => "xRGB",
            RGBx => "RGBx",
            BGR => "BGR",
            IYU2 => "IYU2",
            v308 => "v308",
            RGB => "RGB",
            Y42B => "Y42B",
            NV61 => "NV61",
            NV16 => "NV16",
            VYUY => "VYUY",
            UYVY => "UYVY",
            YVYU => "YVYU",
            YUY2 => "YUY2",
            I420 => "I420",
            YV12 => "YV12",
            NV21 => "NV21",
            NV12 => "NV12",
            NV12_64Z32 => "NV12_64Z32",
            NV12_4L4 => "NV12_4L4",
            NV12_32L32 => "NV12_32L32",
            Y41B => "Y41B",
            IYU1 => "IYU1",
            YVU9 => "YVU9",
            YUV9 => "YUV9",
            RGB16 => "RGB16",
            BGR16 => "BGR16",
            RGB15 => "RGB15",
            BGR15 => "BGR15",
            RGB8P => "RGB8P",
            GRAY16_LE => "GRAY16_LE",
            GRAY16_BE => "GRAY16_BE",
            GRAY10_LE32 => "GRAY10_LE32",
            GRAY8 => "GRAY8",
        };

        f.write_str(s)
    }
}
